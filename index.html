<!DOCTYPE html>
<html>
<head>
    <title>GPS Tracker</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- LIENS CORRIG√âS AVEC HTTPS:// COMPLET -->
    <link rel="stylesheet" href="unpkg.com" />
    <script src="unpkg.com"></script>

    <style>
        html, body { height: 100%; margin: 0; padding: 0; }
        #map { height: 100vh; width: 100vw; background: #eee; }
        .info {
            position: absolute; top: 10px; left: 10px; z-index: 1000;
            background: white; padding: 15px; border-radius: 8px;
            font-family: sans-serif; box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }
        button { padding: 10px; cursor: pointer; width: 100%; }
    </style>
</head>
<body>

<div class="info">
    <div id="status">Chargement...</div>
    <button onclick="lancerGPS()">ACTIVER LE GPS</button>
</div>

<div id="map"></div>

<script>
    var map, route = [], polyline, marker;

    // On attend que la page soit pr√™te
    window.onload = function() {
        if (typeof L === 'undefined') {
            document.getElementById('status').innerHTML = "Erreur de chargement";
            return;
        }
        
        document.getElementById('status').innerHTML = "Pr√™t √† tracer";

        // Initialisation de la carte
        map = L.map('map').setView([46.6, 2.2], 5);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OSM'
        }).addTo(map);

        polyline = L.polyline([], {color: 'red'}).addTo(map);
        marker = L.marker([0,0]).addTo(map);
    };

    function lancerGPS() {
        document.getElementById('status').innerHTML = "Recherche...";
        
        map.locate({
            watch: true,
            enableHighAccuracy: false, // Plus rapide pour le test
            timeout: 30000
        });

        map.on('locationfound', function(e) {
            document.getElementById('status').innerHTML = "üìç Signal OK";
            route.push(e.latlng);
            polyline.setLatLngs(route);
            marker.setLatLng(e.latlng);
            map.setView(e.latlng, 16);
        });

        map.on('locationerror', function(e) {
            document.getElementById('status').innerHTML = "Erreur: " + e.message;
        });
    }
</script>

</body>
</html>
